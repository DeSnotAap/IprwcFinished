{"ast":null,"code":"import { forkJoin, of } from 'rxjs';\nimport { catchError, switchMap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/category.service\";\nimport * as i2 from \"../../services/book.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/router\";\n\nfunction CategoryListComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵelement(1, \"div\", 7);\n    i0.ɵɵelementStart(2, \"p\");\n    i0.ɵɵtext(3, \"Loading categories...\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction CategoryListComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"p\");\n    i0.ɵɵtext(2, \"An error occurred while loading categories. Please try again later.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 9);\n    i0.ɵɵtext(4, \"Back to Book Catalog\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction CategoryListComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"p\");\n    i0.ɵɵtext(2, \"No categories found.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 9);\n    i0.ɵɵtext(4, \"Browse All Books\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction CategoryListComponent_div_6_div_1_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const category_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(category_r5.description);\n  }\n}\n\nconst _c0 = function (a1) {\n  return [\"/books\", a1];\n};\n\nfunction CategoryListComponent_div_6_div_1_div_4_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22)(1, \"div\", 23);\n    i0.ɵɵelement(2, \"img\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 25)(4, \"h3\", 26);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 27);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 28);\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 29);\n    i0.ɵɵtext(12, \" Add to Cart \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"a\", 30);\n    i0.ɵɵtext(14, \"Details\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const book_r11 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", book_r11.imageUrl, i0.ɵɵsanitizeUrl)(\"alt\", book_r11.title);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(book_r11.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"by \", book_r11.author, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(10, 6, book_r11.price, \"EUR\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(9, _c0, book_r11.id));\n  }\n}\n\nfunction CategoryListComponent_div_6_div_1_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtemplate(1, CategoryListComponent_div_6_div_1_div_4_div_1_Template, 15, 11, \"div\", 21);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const category_r5 = i0.ɵɵnextContext().$implicit;\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r7.getBooksForCategory(category_r5.id));\n  }\n}\n\nfunction CategoryListComponent_div_6_div_1_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31)(1, \"p\");\n    i0.ɵɵtext(2, \"No books available in this category.\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction CategoryListComponent_div_6_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"h2\", 14);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, CategoryListComponent_div_6_div_1_p_3_Template, 2, 1, \"p\", 15);\n    i0.ɵɵtemplate(4, CategoryListComponent_div_6_div_1_div_4_Template, 2, 1, \"div\", 16);\n    i0.ɵɵtemplate(5, CategoryListComponent_div_6_div_1_div_5_Template, 3, 0, \"div\", 17);\n    i0.ɵɵelement(6, \"div\", 18);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const category_r5 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(category_r5.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", category_r5.description);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.hasBooksInCategory(category_r5.id));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r4.hasBooksInCategory(category_r5.id));\n  }\n}\n\nfunction CategoryListComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtemplate(1, CategoryListComponent_div_6_div_1_Template, 7, 4, \"div\", 12);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.categories);\n  }\n}\n\nexport let CategoryListComponent = /*#__PURE__*/(() => {\n  class CategoryListComponent {\n    constructor(categoryService, bookService) {\n      this.categoryService = categoryService;\n      this.bookService = bookService;\n      this.categories = [];\n      this.categoryBooks = new Map();\n      this.loading = true;\n      this.error = false;\n    }\n\n    ngOnInit() {\n      this.loadCategories();\n    }\n\n    loadCategories() {\n      this.loading = true;\n      this.error = false;\n      this.categoryService.getCategories().pipe(switchMap(categories => {\n        this.categories = categories; // If no categories, return empty array\n\n        if (categories.length === 0) {\n          return of([]);\n        } // Create an array of observables for all categories' books\n\n\n        const bookRequests = categories.map(category => this.bookService.getBooksByCategory(category.id).pipe(catchError(() => of([]))));\n        return forkJoin(bookRequests);\n      }), catchError(error => {\n        console.error('Error loading categories:', error);\n        this.error = true;\n        return of([]);\n      })).subscribe(booksArrays => {\n        // Associate each array of books with its category\n        this.categories.forEach((category, index) => {\n          if (booksArrays[index]) {\n            this.categoryBooks.set(category.id, booksArrays[index]);\n          }\n        });\n        this.loading = false;\n      }, () => {\n        this.loading = false;\n        this.error = true;\n      });\n    }\n\n    getBooksForCategory(categoryId) {\n      return this.categoryBooks.get(categoryId) || [];\n    }\n\n    hasBooksInCategory(categoryId) {\n      const books = this.categoryBooks.get(categoryId);\n      return books !== undefined && books.length > 0;\n    }\n\n  }\n\n  CategoryListComponent.ɵfac = function CategoryListComponent_Factory(t) {\n    return new (t || CategoryListComponent)(i0.ɵɵdirectiveInject(i1.CategoryService), i0.ɵɵdirectiveInject(i2.BookService));\n  };\n\n  CategoryListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CategoryListComponent,\n    selectors: [[\"app-category-list\"]],\n    decls: 7,\n    vars: 4,\n    consts: [[1, \"categories-container\"], [1, \"page-title\"], [\"class\", \"loading-spinner\", 4, \"ngIf\"], [\"class\", \"error-message\", 4, \"ngIf\"], [\"class\", \"no-results\", 4, \"ngIf\"], [\"class\", \"categories-list\", 4, \"ngIf\"], [1, \"loading-spinner\"], [1, \"spinner\"], [1, \"error-message\"], [\"routerLink\", \"/books\", 1, \"btn-primary\"], [1, \"no-results\"], [1, \"categories-list\"], [\"class\", \"category-section\", 4, \"ngFor\", \"ngForOf\"], [1, \"category-section\"], [1, \"category-title\"], [\"class\", \"category-description\", 4, \"ngIf\"], [\"class\", \"books-grid\", 4, \"ngIf\"], [\"class\", \"no-books-message\", 4, \"ngIf\"], [1, \"category-divider\"], [1, \"category-description\"], [1, \"books-grid\"], [\"class\", \"book-card\", 4, \"ngFor\", \"ngForOf\"], [1, \"book-card\"], [1, \"book-image\"], [3, \"src\", \"alt\"], [1, \"book-details\"], [1, \"book-title\"], [1, \"book-author\"], [1, \"book-price\"], [1, \"btn-primary\"], [1, \"btn-link\", 3, \"routerLink\"], [1, \"no-books-message\"]],\n    template: function CategoryListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\", 1);\n        i0.ɵɵtext(2, \"Browse by Category\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(3, CategoryListComponent_div_3_Template, 4, 0, \"div\", 2);\n        i0.ɵɵtemplate(4, CategoryListComponent_div_4_Template, 5, 0, \"div\", 3);\n        i0.ɵɵtemplate(5, CategoryListComponent_div_5_Template, 5, 0, \"div\", 4);\n        i0.ɵɵtemplate(6, CategoryListComponent_div_6_Template, 2, 1, \"div\", 5);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.error);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.loading && !ctx.error && ctx.categories.length === 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.loading && !ctx.error && ctx.categories.length > 0);\n      }\n    },\n    directives: [i3.NgIf, i4.RouterLink, i3.NgForOf, i4.RouterLinkWithHref],\n    pipes: [i3.CurrencyPipe],\n    styles: [\".categories-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:2rem 1rem}.page-title[_ngcontent-%COMP%]{color:#8b0000;margin-bottom:2rem;font-size:2rem;text-align:center}.loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(139,0,0,.1);border-radius:50%;border-top-color:#8b0000;animation:spin 1s linear infinite;margin-bottom:1rem}@keyframes spin{to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%], .no-results[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#666}.btn-primary[_ngcontent-%COMP%]{background-color:#8b0000;color:#fff;border:none;padding:.6rem 1rem;border-radius:4px;cursor:pointer;font-weight:500;transition:background-color .2s ease;margin-top:1rem}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#6b0000}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.category-section[_ngcontent-%COMP%]{margin-bottom:3rem}.category-title[_ngcontent-%COMP%]{color:#8b0000;font-size:1.5rem;margin-bottom:.5rem;padding-bottom:.5rem;border-bottom:2px solid #8B0000}.category-description[_ngcontent-%COMP%]{color:#666;margin-bottom:1.5rem}.category-divider[_ngcontent-%COMP%]{height:1px;background-color:#eee;margin:2rem 0}.books-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));grid-gap:1.5rem}.book-card[_ngcontent-%COMP%]{background:white;border-radius:8px;box-shadow:0 2px 10px #0000001a;overflow:hidden;transition:transform .3s ease,box-shadow .3s ease}.book-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 5px 15px #0000001a}.book-image[_ngcontent-%COMP%]{height:200px;overflow:hidden;position:relative}.book-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .3s ease}.book-card[_ngcontent-%COMP%]:hover   .book-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.05)}.book-details[_ngcontent-%COMP%]{padding:1rem}.book-title[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1rem;font-weight:600;color:#333;height:2.4em;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.book-author[_ngcontent-%COMP%]{color:#666;margin-bottom:.5rem;font-style:italic;font-size:.9rem}.book-price[_ngcontent-%COMP%]{font-weight:700;color:#8b0000;margin-bottom:.5rem}.book-stock[_ngcontent-%COMP%]{color:#2e7d32;font-size:.8rem;margin-bottom:.5rem}.book-stock.out-of-stock[_ngcontent-%COMP%]{color:#c62828}.btn-outline[_ngcontent-%COMP%]{background-color:transparent;color:#666;border:1px solid #ccc;padding:.5rem;border-radius:4px;cursor:not-allowed;font-weight:500;width:100%;font-size:.8rem;margin-bottom:.5rem}.btn-link[_ngcontent-%COMP%]{display:block;text-align:center;color:#8b0000;text-decoration:none;font-size:.9rem}.btn-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.no-books-message[_ngcontent-%COMP%]{padding:1rem;text-align:center;color:#666;font-style:italic;background-color:#f8f8f8;border-radius:8px}\"]\n  });\n  return CategoryListComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}